{"ast":null,"code":"var _jsxFileName = \"/home/carina/priv/trot-race-simulator/client/src/App.jsx\";\nimport React from 'react';\nimport socketIOClient from 'socket.io-client';\nimport _ from 'underscore';\nimport Cookies from 'js-cookie';\nimport './style.scss';\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      startResponse: false,\n      finishResponse: false,\n      endpoint: 'http://127.0.0.1:4001',\n      update: ''\n    };\n    this.getTimeInSeconds = this.getTimeInSeconds.bind(this);\n  }\n\n  componentWillMount() {\n    const {\n      endpoint\n    } = this.state;\n    const socket = socketIOClient(endpoint);\n    socket.on('StartHorses', dataA => this.setState({\n      startResponse: dataA,\n      update: 'start'\n    }));\n    socket.on('FinishHorses', dataB => this.setState({\n      finishResponse: dataB,\n      update: 'finish'\n    }));\n  }\n\n  renderTableData(type) {\n    const {\n      startResponse\n    } = this.state;\n\n    if (type === 'start') {\n      return this.getTableData(startResponse);\n    } else if (type === 'finish') {\n      const jsonData = Cookies.get('results');\n      const horses = JSON.parse(jsonData);\n      const finishHorse = this.state.finishResponse;\n\n      let filtered = _.filter(horses, function (item) {\n        return item.horse.name !== finishHorse.horse.name;\n      });\n\n      filtered.push(finishHorse);\n      return this.getTableData(filtered);\n    }\n\n    return;\n  }\n\n  getTableData(data) {\n    return Object.keys(data.sort(this.compare)).map(function (key) {\n      const id = data[key].horse.name.replace(' ', '-');\n      var jsonData = JSON.stringify(data);\n      Cookies.set('results', jsonData);\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: key,\n        id: id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 13\n        }\n      }, data[key].horse.id), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 13\n        }\n      }, data[key].horse.name), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 13\n        }\n      }, data[key].time < 99999 ? this.getTimeInSeconds(data[key].time) : ''));\n    });\n  }\n\n  getTimeInSeconds(time) {\n    const minutes = Math.floor(time / 60000);\n    console.log('time', time);\n    const seconds = (time % 60000 / 1000).toFixed(0);\n    return minutes + \",\" + (seconds < 10 ? '0' : '') + seconds + ' s';\n  }\n\n  compare(a, b) {\n    const timeA = a.time;\n    const timeB = b.time;\n    let comparison = 0;\n\n    if (timeA > timeB) {\n      comparison = 1;\n    } else if (timeA < timeB) {\n      comparison = -1;\n    }\n\n    return comparison;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      id: \"results\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }\n    }, \"No\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }\n    }, \"Horse\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"Time\")), this.state.update && this.renderTableData(this.state.update))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/carina/priv/trot-race-simulator/client/src/App.jsx"],"names":["React","socketIOClient","_","Cookies","App","Component","constructor","state","startResponse","finishResponse","endpoint","update","getTimeInSeconds","bind","componentWillMount","socket","on","dataA","setState","dataB","renderTableData","type","getTableData","jsonData","get","horses","JSON","parse","finishHorse","filtered","filter","item","horse","name","push","data","Object","keys","sort","compare","map","key","id","replace","stringify","set","time","minutes","Math","floor","console","log","seconds","toFixed","a","b","timeA","timeB","comparison","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport socketIOClient from 'socket.io-client';\nimport _ from 'underscore';\nimport Cookies from 'js-cookie';\nimport './style.scss';\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      startResponse: false,\n      finishResponse: false,\n      endpoint: 'http://127.0.0.1:4001',\n      update: '',\n    };\n    this.getTimeInSeconds = this.getTimeInSeconds.bind(this);\n  }\n\n  componentWillMount() {\n    const { endpoint } = this.state;\n    const socket = socketIOClient(endpoint);\n    socket.on('StartHorses', dataA => this.setState({ startResponse: dataA, update: 'start' }));\n    socket.on('FinishHorses', dataB => this.setState({ finishResponse: dataB, update: 'finish' }));\n  }\n\n\n\n  renderTableData(type) {\n    const { startResponse } = this.state;\n\n    if (type === 'start') {\n      return this.getTableData(startResponse);\n    }\n    else if (type === 'finish') {\n      const jsonData = Cookies.get('results');\n      const horses = JSON.parse(jsonData);\n      const finishHorse = this.state.finishResponse;\n\n      let filtered = _.filter(horses, function(item) {\n        return item.horse.name !== finishHorse.horse.name;\n      });\n\n      filtered.push(finishHorse);\n      return this.getTableData(filtered);\n    }\n    return;\n  }\n\n  getTableData(data){\n    return Object.keys(data.sort(this.compare)).map(function(key) {\n      const id = data[key].horse.name.replace(' ', '-');\n      var jsonData = JSON.stringify(data);\n      Cookies.set('results', jsonData);\n      return (\n        <tr key={key} id={id}>\n            <td>{data[key].horse.id}</td>\n            <td>{data[key].horse.name}</td>\n            <td>{data[key].time < 99999 ? this.getTimeInSeconds(data[key].time) : ''}</td>\n        </tr>\n      )\n    });\n  }\n\n  getTimeInSeconds(time) {\n    const minutes = Math.floor(time / 60000);\n    console.log('time', time);\n    const seconds = ((time % 60000) / 1000).toFixed(0);\n    return minutes + \",\" + (seconds < 10 ? '0' : '') + seconds + ' s';\n  }\n\n  compare(a, b) {\n    const timeA = a.time;\n    const timeB = b.time;\n\n    let comparison = 0;\n    if (timeA > timeB) {\n      comparison = 1;\n    } else if (timeA < timeB) {\n      comparison = -1;\n    }\n    return comparison;\n  }\n\n  render() {\n    return (\n        <div>\n          <table id='results'>\n            <tbody>\n              <tr>\n                <th>No</th>\n                <th>Horse</th>\n                <th>Time</th>\n              </tr>\n                {this.state.update &&\n                  this.renderTableData(this.state.update)\n                }\n            </tbody>\n          </table>\n        </div>\n    );\n  }\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}